enum SaleStatus {
  pending
  approved
  refunded
  paid
  duplicate
  fraud
}

model Sale {
  id                  String         @id @default(cuid())
  programId           String
  partnerId           String
  payoutId            String?
  linkId              String
  clickId             String
  customerId          String
  invoiceId           String?
  eventId             String
  eventName           String
  paymentProcessor    String
  amount              Int
  currency            String
  commissionAmount    Float
  commissionType      CommissionType
  commissionEarned    Int?
  recurringCommission Boolean
  recurringDuration   Int?
  recurringCount      Int?
  nextRecurringDate   DateTime?
  isLifetimeRecurring Boolean
  status              SaleStatus
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  program  Program  @relation(fields: [programId], references: [id])
  partner  Partner  @relation(fields: [partnerId], references: [id])
  payout   Payout?  @relation(fields: [payoutId], references: [id])
  customer Customer @relation(fields: [customerId], references: [id])

  @@index([programId])
  @@index([partnerId])
  @@index([payoutId])
  @@index([customerId])
}
