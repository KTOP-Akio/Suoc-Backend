enum SaleStatus {
  pending
  reconciled
  paid
  refunded
  duplicate
  fraud
}

model Sale {
  id                  String              @id @default(cuid())
  programId           String
  partnerId           String
  payoutId            String?
  linkId              String
  clickId             String
  customerId          String
  invoiceId           String?
  eventId             String
  eventName           String
  paymentProcessor    String
  amount              Int
  currency            String
  commissionEarned    Int
  commissionAmount    Float
  commissionType      CommissionType
  recurringCommission Boolean
  recurringInterval   CommissionInterval?
  recurringDuration   Int?
  isLifetimeRecurring Boolean?
  status              SaleStatus          @default(pending)
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt

  program  Program  @relation(fields: [programId], references: [id])
  partner  Partner  @relation(fields: [partnerId], references: [id])
  payout   Payout?  @relation(fields: [payoutId], references: [id])
  customer Customer @relation(fields: [customerId], references: [id])

  @@index([programId])
  @@index([partnerId])
  @@index([payoutId])
  @@index([customerId])
}
