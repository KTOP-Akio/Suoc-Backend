model Discount {
  id String @id @default(cuid())

  amount      Int            @default(0)
  type        CommissionType @default(percentage)
  maxDuration Int? // in months (0 -> not recurring, null -> lifetime)

  couponId     String?
  couponTestId String?

  workspaceId String
  programId   String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  program            Program             @relation(fields: [programId], references: [id])
  programEnrollments ProgramEnrollment[]
  partners           PartnerDiscount[]

  // TO be removed
  duration Int?
  interval CommissionInterval?

  @@index(programId)
}

model PartnerDiscount {
  id                  String @id @default(cuid())
  programEnrollmentId String
  discountId          String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  programEnrollment ProgramEnrollment @relation(fields: [programEnrollmentId], references: [id], onDelete: Cascade)
  discount          Discount          @relation(fields: [discountId], references: [id], onDelete: Cascade)

  @@unique([programEnrollmentId, discountId])
  @@index(programEnrollmentId)
  @@index(discountId)
}
